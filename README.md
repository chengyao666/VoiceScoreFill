ä¸‹é¢æ˜¯ **é€‚é… WPS äº‘ç«¯è¡¨æ ¼ï¼ˆWPS ç½‘é¡µç‰ˆ Excelï¼‰** çš„ä¸“ä¸šçº§ **å®Œæ•´æŠ€æœ¯æ–¹æ¡ˆï¼ˆMarkdown ç‰ˆï¼‰**ï¼ŒåŒ…å«ä¸šåŠ¡æµç¨‹ã€æŠ€æœ¯æ ˆã€æ¶æ„ã€æ¨¡å—è®¾è®¡ã€æ•°æ®ç»“æ„ã€å…³é”®ç®—æ³•ã€é£é™©æ§åˆ¶ã€æµ‹è¯•æ–¹æ¡ˆç­‰ã€‚
å¯ç›´æ¥ä½œä¸ºç«‹é¡¹æ–‡æ¡£ / æŠ€æœ¯è¯„å®¡æ–‡æ¡£ä½¿ç”¨ã€‚

---

# # ğŸ“˜ é¡¹ç›®åç§°ï¼š**VoiceSheet Navigator**

**ä¸€å¥è¯ç®€ä»‹**ï¼š
åœ¨ WPS äº‘ç«¯è¡¨æ ¼ä¸­ï¼Œé€šè¿‡è¯­éŸ³è¾“å…¥å­¦ç”Ÿå§“åä¸åˆ†æ•°ï¼Œå®ç°æ™ºèƒ½å®šä½è¡Œåˆ—å¹¶è‡ªåŠ¨å¡«å…¥æˆç»©ï¼Œå…¨æµç¨‹ **çº¯ç«¯ä¾§ï¼Œæ— éœ€æœåŠ¡å™¨**ã€‚

---

# # 1. â­ é¡¹ç›®èƒŒæ™¯ä¸æ ¸å¿ƒç›®æ ‡

## 1.1 èƒŒæ™¯

æ•™å¸ˆåœ¨å½•å…¥æˆç»©æ—¶ï¼Œä¼ ç»Ÿçš„ Excel æ‰‹åŠ¨æ“ä½œè€—æ—¶æ•ˆç‡ä½ã€‚WPS äº‘ç«¯ Excel æ— æ³•è¿è¡Œ VBA/å®ã€æ— æ’ä»¶ä½“ç³»ï¼Œä¸”äº‘ç«¯æƒé™é™åˆ¶å¤šã€‚

æœ¬æ–¹æ¡ˆæ—¨åœ¨ï¼š

* å®ç°åœ¨ WPS äº‘ç«¯è¡¨æ ¼ä¸­ **é€šè¿‡è¯­éŸ³å¿«é€Ÿå½•åˆ†**
* å…¼å®¹ **æµè§ˆå™¨ç¯å¢ƒ**ï¼ˆChrome / Edgeï¼‰
* **çº¯ç«¯ä¾§è¿è¡Œï¼Œæ— éœ€æœåŠ¡å™¨**
* æ— éœ€æ›´æ”¹ WPS è¡¨æ ¼åå°ï¼Œæ— é¢å¤–æƒé™

---

## 1.2 æ ¸å¿ƒç›®æ ‡

| åŠŸèƒ½            | æè¿°                |
| ------------- | ----------------- |
| **è¯­éŸ³è¯†åˆ«ï¼ˆä¸­æ–‡ï¼‰**  | æµè§ˆå™¨æœ¬åœ°è¯†åˆ«å§“å + åˆ†æ•°    |
| **è‡ªåŠ¨å®šä½å­¦ç”Ÿæ‰€åœ¨è¡Œ** | åœ¨å§“ååˆ—æŸ¥æ‰¾ä¸è¯­éŸ³åŒ¹é…çš„å­¦ç”Ÿ    |
| **è‡ªåŠ¨åŒ¹é…å½“å‰å­¦ç§‘åˆ—** | æ ¹æ®å½“å‰é€‰ä¸­å•å…ƒæ ¼æ‰€åœ¨åˆ—ç¡®å®šå¡«åˆ†åˆ— |
| **è‡ªåŠ¨å¡«å…¥æˆç»©**    | æ¨¡æ‹Ÿç”¨æˆ·æ“ä½œï¼Œå¯¹ç›®æ ‡å•å…ƒæ ¼å¡«å€¼   |
| **çº¯ç«¯ä¾§è¿è¡Œ**     | ä¸ä¾èµ–åç«¯/æœåŠ¡å™¨/API     |

---

# # 2. â­ æ€»ä½“ä¸šåŠ¡æµç¨‹

```mermaid
flowchart TD
    A[å¼€å¯ Chrome æ’ä»¶] --> B[Web Speech API å¼€å§‹ç›‘å¬è¯­éŸ³]
    B --> C[è¯†åˆ«æ–‡æœ¬ï¼Œå¦‚â€œæå›› 89â€]
    C --> D[è§£ææ–‡æœ¬ â†’ {name: æå››, score: 89}]
    D --> E[æ’ä»¶æ‰«æ WPS è¡¨æ ¼ DOM]
    E --> F[åœ¨å§“ååˆ—åŒ¹é…åˆ°â€œæå››â€æ‰€åœ¨è¡Œ]
    F --> G[è¯»å–ç”¨æˆ·å½“å‰é€‰ä¸­çš„åˆ—ï¼ˆå½“å‰å­¦ç§‘ï¼‰]
    G --> H[å®šä½ (row, col) å•å…ƒæ ¼]
    H --> I[è‡ªåŠ¨å¡«å…¥æˆç»© 89]
    I --> J[ç­‰å¾…ä¸‹ä¸€æ¬¡è¯­éŸ³]
```

---

# # 3. â­ å…³é”®æŠ€æœ¯é€‰å‹ï¼ˆæŠ€æœ¯æ ˆï¼‰

| æ¨¡å—          | æŠ€æœ¯æ–¹æ¡ˆ                         | è¯´æ˜           |
| ----------- | ---------------------------- | ------------ |
| **è¯­éŸ³è¯†åˆ«**    | Web Speech APIï¼ˆChrome å†…ç½®ï¼‰    | çº¯æœ¬åœ°ï¼Œä½å»¶è¿Ÿ      |
| **æµè§ˆå™¨æ‰©å±•å¼€å‘** | Chrome Extension Manifest V3 | éƒ½åœ¨æœ¬åœ°è¿è¡Œ       |
| **ä¸»é€»è¾‘è„šæœ¬**   | Content Script (JavaScript)  | æ“ä½œ WPS DOM   |
| **UI ç»„ä»¶**   | Popup.html + CSS             | å¯åœè¯­éŸ³ã€çŠ¶æ€æç¤º    |
| **æ•°æ®å­˜å‚¨**    | chrome.storage.local         | å­˜å‚¨é…ç½®ï¼Œå¦‚å§“ååˆ—ç´¢å¼•  |
| **é¡µé¢äº¤äº’**    | DOM Query + execCommand      | å¡«åˆ†ä¸å®šä½        |
| **åå­—åŒ¹é…**    | æ­£åˆ™ä¸è¿‘ä¼¼åŒ¹é…ï¼ˆæ”¯æŒå®¹é”™ï¼‰                | é¿å…è¯†åˆ«é”™è¯¯å¯¼è‡´å®šä½å¤±è´¥ |

---

# # 4. â­ äº§å“ä¸šåŠ¡è®¾è®¡

## 4.1 åŠŸèƒ½åˆ—è¡¨

| åŠŸèƒ½        | çŠ¶æ€ | æè¿°            |
| --------- | -- | ------------- |
| è¯­éŸ³ç›‘å¬å¼€å…³    | âœ”  | æ’ä»¶ Popup æ§åˆ¶   |
| è¯­éŸ³è¯†åˆ«è½¬æ–‡æœ¬   | âœ”  | è‡ªåŠ¨ç›‘å¬ä¸­æ–‡è¾“å…¥      |
| å§“å & åˆ†æ•°è§£æ | âœ”  | æå–å§“å + æ•°å­—     |
| å§“ååˆ—é…ç½®     | âœ”  | é»˜è®¤åˆ— Bï¼Œå¯è‡ªå®šä¹‰    |
| è‡ªåŠ¨æœç´¢å­¦ç”Ÿè¡Œ   | âœ”  | DOM æ‰«æåå­—åˆ—     |
| å®šä½å½“å‰åˆ—     | âœ”  | ç›‘å¬å½“å‰é€‰ä¸­å•å…ƒæ ¼     |
| è‡ªåŠ¨å¡«åˆ†      | âœ”  | è‡ªåŠ¨è¾“å…¥è¯†åˆ«åˆ°çš„æˆç»©    |
| å®¹é”™å¤„ç†      | âœ”  | è¯†åˆ«æ¨¡ç³Šåå­—ã€å¼‚å¸¸æé†’   |
| æ—¥å¿—/è°ƒè¯•æ¨¡å¼   | âœ”  | æ–¹ä¾¿æ’æŸ¥ DOM ç»“æ„å˜åŒ– |

---

## 4.2 ç”¨æˆ·æ“ä½œæµç¨‹ï¼ˆæ•™å¸ˆè§’åº¦ï¼‰

1. æ‰“å¼€ WPS äº‘ç«¯è¡¨æ ¼
2. åœ¨å½“å‰å­¦ç§‘åˆ—éšæ„ç‚¹å‡»ä¸€ä¸ªå•å…ƒæ ¼ï¼ˆä½œä¸ºå½“å‰åˆ—ï¼‰
3. ç‚¹å‡»æµè§ˆå™¨å³ä¸Šè§’æ’ä»¶å›¾æ ‡ â†’ â€œStart Voice Inputâ€
4. å¯¹ç€éº¦å…‹é£è¯´ï¼š
   **â€œå¼ ä¸‰ 89 åˆ†â€**
5. æ’ä»¶è‡ªåŠ¨ï¼š

   * æ‰¾åˆ°â€œå¼ ä¸‰â€æ‰€åœ¨è¡Œ
   * æ‰¾åˆ°å½“å‰å­¦ç§‘åˆ—
   * å¡«å…¥åˆ†æ•°
6. è‡ªåŠ¨ç­‰å¾…ä¸‹ä¸€æ¬¡è¯­éŸ³è¾“å…¥
7. å…¨éƒ¨å½•å®Œåï¼Œç‚¹å‡»â€œStopâ€ç»“æŸ

---

# # 5. â­ ç³»ç»Ÿæ¶æ„è®¾è®¡

```mermaid
graph LR
    A[Popup UI] -->|Start/Stop| B[Background Service]
    B --> C[Content Script Injected into WPS]
    C --> D[WPS Web Excel DOM]
    B --> E[Web Speech API]
    E --> B
    B --> C
```

---

# # 6. â­ æ¨¡å—è®¾è®¡ï¼ˆæœ€å…³é”®éƒ¨åˆ†ï¼‰

## 6.1 Web Speech API æ¨¡å—

```js
const recognition = new webkitSpeechRecognition();
recognition.lang = "zh-CN";
recognition.interimResults = false;

recognition.onresult = (event) => {
  const text = event.results[0][0].transcript;
  chrome.runtime.sendMessage({ type: "VOICE_TEXT", text });
};
```

---

## 6.2 æ–‡æœ¬è§£ææ¨¡å—ï¼ˆContent Scriptï¼‰

ç›®æ ‡æ–‡æœ¬æ ¼å¼ï¼š

* â€œå¼ ä¸‰ 89â€
* â€œæå››ï¼Œ87 åˆ†â€
* â€œç‹å°æ˜ å¾—åˆ† 92â€

### æ­£åˆ™è§£æ

```js
function parseInput(text) {
  const match = text.match(/([\u4e00-\u9fa5]{2,})\D*(\d{1,3})/);
  if (!match) return null;
  return { name: match[1], score: Number(match[2]) };
}
```

---

## 6.3 å§“åå®šä½æ¨¡å—

å‡è®¾ç”¨æˆ·è®¾ç½®å§“ååˆ—ä¸º Bï¼ˆç¬¬ 2 åˆ—ï¼‰ï¼š

```js
function findRowIndexByName(name) {
  const cells = document.querySelectorAll('[data-row][data-col="2"]');

  for (let cell of cells) {
    if (cell.innerText.trim() === name) {
      return cell.dataset.row;
    }
  }
  return null;
}
```

---

## 6.4 å½“å‰é€‰ä¸­åˆ—æ•è·æ¨¡å—

ç›‘å¬å•å…ƒæ ¼ç‚¹å‡»äº‹ä»¶ï¼š

```js
let currentCol = null;

document.addEventListener('click', e => {
  const cell = e.target.closest('[data-row][data-col]');
  if (cell) currentCol = cell.dataset.col;
});
```

---

## 6.5 è‡ªåŠ¨å¡«åˆ†æ¨¡å—

```js
function fillScore(row, col, score) {
  const cell = document.querySelector(`[data-row="${row}"][data-col="${col}"]`);
  if (cell) {
    cell.click();
    document.execCommand("insertText", false, String(score));
  }
}
```

---

# # 7. â­ æ•°æ®ç»“æ„

| åç§°            | ç±»å‹     | ç¤ºä¾‹                        | è¯´æ˜             |
| ------------- | ------ | ------------------------- | -------------- |
| VoiceResult   | Object | `{name: "å¼ ä¸‰", score: 89}` | è¯­éŸ³è§£æåçš„æ•°æ®       |
| StudentRow    | Number | `12`                      | åœ¨ WPS DOM ä¸­çš„è¡Œå· |
| CurrentColumn | Number | `5`                       | å½“å‰æ‰€å½•å­¦ç§‘åˆ—        |
| Config        | Object | `{ nameColumn: 2 }`       | ç”¨æˆ·è‡ªå®šä¹‰é…ç½®        |

---

# # 8. â­ Chrome æ’ä»¶ç›®å½•ç»“æ„

```
voice-sheet-navigator/
â”œâ”€â”€ manifest.json
â”œâ”€â”€ popup/
â”‚   â”œâ”€â”€ popup.html
â”‚   â”œâ”€â”€ popup.js
â”‚   â””â”€â”€ popup.css
â”œâ”€â”€ background/
â”‚   â””â”€â”€ background.js
â”œâ”€â”€ content/
â”‚   â””â”€â”€ content-script.js
â””â”€â”€ assets/
    â””â”€â”€ icon.png
```

---

# # 9. â­ manifest.jsonï¼ˆæ ¸å¿ƒï¼‰

```json
{
  "manifest_version": 3,
  "name": "VoiceSheet Navigator",
  "version": "1.0",
  "description": "Voice-controlled score entry for WPS spreadsheets.",
  "permissions": ["storage"],
  "background": {
    "service_worker": "background/background.js"
  },
  "action": {
    "default_popup": "popup/popup.html"
  },
  "content_scripts": [
    {
      "matches": ["https://*.wps.cn/*", "https://*.kdocs.cn/*"],
      "js": ["content/content-script.js"]
    }
  ]
}
```

---

# # 10. â­ é£é™©ä¸è§£å†³æ–¹æ¡ˆ

| é£é™©              | åŸå›                   | è§£å†³æ–¹æ¡ˆ                    |
| --------------- | ------------------- | ----------------------- |
| WPS äº‘ç«¯ DOM ç»“æ„å˜åŠ¨ | WPS æ›´æ–°å‰ç«¯            | è®¾ç½® DOM å®¹é”™ / æä¾› Debug æ¨¡å¼ |
| è¯­éŸ³è¯¯è¯†åˆ«å§“å         | Web Speech API ç²¾åº¦æ³¢åŠ¨ | åŠ â€œå§“ååŒ¹é…ç¡®è®¤æç¤ºâ€å¯é€‰é¡¹          |
| å•å…ƒæ ¼å®šä½å¤±è´¥         | è¡¨æ ¼åˆå¹¶å•å…ƒæ ¼             | æä¾›æ‰‹åŠ¨é‡æ–°é€‰åˆ—åŠŸèƒ½              |
| æµè§ˆå™¨æƒé™é—®é¢˜         | éº¦å…‹é£æ‹’ç»æˆæƒ             | å¯åŠ¨æ—¶æ£€æµ‹éº¦å…‹é£æƒé™              |

---

# # 11. â­ æµ‹è¯•æ–¹æ¡ˆ

## 11.1 å•å…ƒæµ‹è¯•

| æ¨¡å—       | æµ‹è¯•ç‚¹          |
| -------- | ------------ |
| æ–‡æœ¬è§£ææ¨¡å—   | æ­£åˆ™æå–æ­£ç¡®ã€é”™è¯¯ã€å¼‚å¸¸ |
| DOM å®šä½æ¨¡å— | æ‰¾åˆ°å¯¹åº”è¡Œ/åˆ—      |
| è‡ªåŠ¨å¡«åˆ†æ¨¡å—   | æ­£å¸¸è¾“å…¥ã€è¦†ç›–è¾“å…¥    |

## 11.2 é›†æˆæµ‹è¯•

* åœ¨ WPS äº‘è¡¨æ ¼ä¸Šå®é™…æµ‹è¯•
* 10 ä¸ªå­¦ç”Ÿï¼Œ3 ä¸ªç§‘ç›®ï¼Œå½• 30 æ¡è¯­éŸ³
* ç»Ÿè®¡æˆåŠŸç‡ â‰¥ 95%

## 11.3 æ€§èƒ½æµ‹è¯•

* è¿ç»­å½•å…¥ 50 æ¬¡è¯­éŸ³æ“ä½œ
* æ— æ˜æ˜¾å»¶è¿Ÿï¼Œæ— å†…å­˜æ³„æ¼

---

# # 12. â­ åç»­æ‰©å±•æ–¹å‘

* æ”¯æŒ **æ¨¡ç³ŠåŒ¹é…å­¦ç”Ÿå§“å**ï¼ˆè§£å†³å£°å­¦è¯†åˆ«è¯¯å·®ï¼‰
* æ”¯æŒ **è¯­éŸ³è¿ç»­æ¨¡å¼**ï¼ˆæ— éœ€æ¯æ¬¡åœé¡¿ï¼‰
* æ”¯æŒ **è‡ªå®šä¹‰å‘½ä»¤**ï¼ˆå¦‚â€œä¸‹ä¸€ä½â€â€œä¸Šä¸€è¡Œâ€ï¼‰
* æ”¯æŒ **iPad + WPS å°ç¨‹åº** ç«¯ä¾§å½•åˆ†ï¼ˆMiniApp + Whisper.cppï¼‰

---

# # 13. â­ ç»“è®º

æœ¬æŠ€æœ¯æ–¹æ¡ˆå®Œå…¨é€‚é… **WPS äº‘ç«¯è¡¨æ ¼** çš„é™åˆ¶ï¼Œé€šè¿‡ Chrome æ’ä»¶ + æœ¬åœ°è¯­éŸ³è¯†åˆ«ï¼Œå®ç° â€œå–Šåå­— â†’ Excel å®šä½ â†’ è‡ªåŠ¨å¡«åˆ†â€ï¼Œå¯ç¨³å®šè¿è¡Œã€å®Œå…¨æœ¬åœ°åŒ–ã€ä¸ä¾èµ–ä»»ä½•æœåŠ¡å™¨ã€‚
